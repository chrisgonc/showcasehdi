VIEW "VW_CARD_GDPR" AS
SELECT
	"CARD_ID",
	"CARD_NUM",
	"CARD_VALIDITY",
	"CARD_FLAG",
	"CARD_CATEGORY",
	"CARD_INTERNATIONAL",
	CASE WHEN (B.AM_MASKING_TYPE IS NULL OR LOCATE(B.AM_MASKING_TYPE,'A1')=0) THEN TO_SMALLINT(F_MASKING('A1')) ELSE "CARD_LIMIT" END AS CARD_LIMIT,
--	"CARD_LIMIT",
	"CARD_STATUS"
FROM "CARD" A LEFT OUTER JOIN "AUTHORIZATION_MAPPING" B ON (SESSION_USER=B.AM_USER_ID AND AM_TABLE='CARD')
WITH MASK (CARD_NUM USING CONCAT('************', RIGHT("CARD_NUM", 4)));